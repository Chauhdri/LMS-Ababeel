{"ast":null,"code":"import _regeneratorRuntime from\"D:/Ababeel/LMS/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/Ababeel/LMS/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/Ababeel/LMS/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{useAuthState}from\"react-firebase-hooks/auth\";import{query,collection,getDocs,where}from\"firebase/firestore\";import{auth}from\"./components/firebaseServer\";import{useNavigate}from'react-router-dom';import Students from'./students';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Dashboard(props){var _useAuthState=useAuthState(auth),_useAuthState2=_slicedToArray(_useAuthState,3),user=_useAuthState2[0],loading=_useAuthState2[1],error=_useAuthState2[2];var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),permission=_useState4[0],setPermission=_useState4[1];var navigate=useNavigate();var fetchPermission=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:userData[\"Role\"][props.role]&&setPermission(true);case 1:case\"end\":return _context.stop();}}},_callee);}));return function fetchPermission(){return _ref.apply(this,arguments);};}();useEffect(function(){if(loading)return;if(!user)return navigate(\"/\");fetchUserEmail();},[user,loading]);//fetching data from auth\nvar fetchUserEmail=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var q,doc,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;q=query(collection(db,\"users\"),where(\"uid\",\"==\",user===null||user===void 0?void 0:user.uid));_context2.next=4;return getDocs(q);case 4:doc=_context2.sent;data=doc.docs[0].data();setEmail(data.email);emailVerifying(data.email);_context2.next=14;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](0);console.error(_context2.t0);alert(\"An error occured while fetching user data\");case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[0,10]]);}));return function fetchUserEmail(){return _ref2.apply(this,arguments);};}();//verifying either user data exits or not\nvar emailVerifying=function emailVerifying(email){};return/*#__PURE__*/_jsx(_Fragment,{children:permission&&user&&/*#__PURE__*/_jsx(Students,{})});}","map":{"version":3,"names":["React","useEffect","useState","useAuthState","query","collection","getDocs","where","auth","useNavigate","Students","Dashboard","props","user","loading","error","email","setEmail","permission","setPermission","navigate","fetchPermission","userData","role","fetchUserEmail","q","db","uid","doc","data","docs","emailVerifying","console","alert"],"sources":["D:/Ababeel/LMS/src/pages/dashboard.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useAuthState } from \"react-firebase-hooks/auth\";\r\nimport { query, collection, getDocs, where } from \"firebase/firestore\";\r\nimport { auth } from \"./components/firebaseServer\";\r\nimport { useNavigate } from 'react-router-dom';\r\nimport Students from './students';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport default function Dashboard(props) {\r\n\r\n    const [user, loading, error] = useAuthState(auth);\r\n    const [email, setEmail] = useState(\"\");\r\n    const [permission, setPermission] = useState(false);\r\n    const navigate = useNavigate();\r\n\r\n    const fetchPermission = async () => { userData[\"Role\"][props.role]&& setPermission(true);}\r\n\r\n\r\n\r\n    useEffect(() => {\r\n        if (loading) return;\r\n        if (!user) return navigate(\"/\");\r\n        fetchUserEmail();\r\n    }, [user, loading]);\r\n\r\n    //fetching data from auth\r\n    const fetchUserEmail = async () => {\r\n        try {\r\n            const q = query(collection(db, \"users\"), where(\"uid\", \"==\", user?.uid));\r\n            const doc = await getDocs(q);\r\n            const data = doc.docs[0].data();\r\n            setEmail(data.email);\r\n            emailVerifying(data.email);\r\n        } catch (err) {\r\n            console.error(err);\r\n            alert(\"An error occured while fetching user data\");\r\n        }\r\n    };\r\n\r\n    //verifying either user data exits or not\r\n    const emailVerifying = (email) => {\r\n        \r\n    }\r\n\r\n\r\n    return (\r\n\r\n        <>\r\n        {permission&&user&&<Students />}\r\n        \r\n    </>\r\n\r\n    )\r\n}"],"mappings":"4TAAA,MAAOA,MAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,YAAT,KAA6B,2BAA7B,CACA,OAASC,KAAT,CAAgBC,UAAhB,CAA4BC,OAA5B,CAAqCC,KAArC,KAAkD,oBAAlD,CACA,OAASC,IAAT,KAAqB,6BAArB,CACA,OAASC,WAAT,KAA4B,kBAA5B,CACA,MAAOC,SAAP,KAAqB,YAArB,C,gGASA,cAAe,SAASC,UAAT,CAAmBC,KAAnB,CAA0B,CAErC,kBAA+BT,YAAY,CAACK,IAAD,CAA3C,gDAAOK,IAAP,mBAAaC,OAAb,mBAAsBC,KAAtB,mBACA,cAA0Bb,QAAQ,CAAC,EAAD,CAAlC,wCAAOc,KAAP,eAAcC,QAAd,eACA,eAAoCf,QAAQ,CAAC,KAAD,CAA5C,yCAAOgB,UAAP,eAAmBC,aAAnB,eACA,GAAMC,SAAQ,CAAGX,WAAW,EAA5B,CAEA,GAAMY,gBAAe,4FAAG,qIAAcC,QAAQ,CAAC,MAAD,CAAR,CAAiBV,KAAK,CAACW,IAAvB,GAA+BJ,aAAa,CAAC,IAAD,CAA5C,CAAd,sDAAH,kBAAfE,gBAAe,0CAArB,CAIApB,SAAS,CAAC,UAAM,CACZ,GAAIa,OAAJ,CAAa,OACb,GAAI,CAACD,IAAL,CAAW,MAAOO,SAAQ,CAAC,GAAD,CAAf,CACXI,cAAc,GACjB,CAJQ,CAIN,CAACX,IAAD,CAAOC,OAAP,CAJM,CAAT,CAMA;AACA,GAAMU,eAAc,6FAAG,0KAETC,CAFS,CAELrB,KAAK,CAACC,UAAU,CAACqB,EAAD,CAAK,OAAL,CAAX,CAA0BnB,KAAK,CAAC,KAAD,CAAQ,IAAR,CAAcM,IAAd,SAAcA,IAAd,iBAAcA,IAAI,CAAEc,GAApB,CAA/B,CAFA,wBAGGrB,QAAO,CAACmB,CAAD,CAHV,QAGTG,GAHS,gBAITC,IAJS,CAIFD,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYD,IAAZ,EAJE,CAKfZ,QAAQ,CAACY,IAAI,CAACb,KAAN,CAAR,CACAe,cAAc,CAACF,IAAI,CAACb,KAAN,CAAd,CANe,qFAQfgB,OAAO,CAACjB,KAAR,eACAkB,KAAK,CAAC,2CAAD,CAAL,CATe,uEAAH,kBAAdT,eAAc,2CAApB,CAaA;AACA,GAAMO,eAAc,CAAG,QAAjBA,eAAiB,CAACf,KAAD,CAAW,CAEjC,CAFD,CAKA,mBAEI,yBACCE,UAAU,EAAEL,IAAZ,eAAkB,KAAC,QAAD,IADnB,EAFJ,CAQH"},"metadata":{},"sourceType":"module"}